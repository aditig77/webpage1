<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Tourist Safety System</title>
     <!-- Leaflet Map Library -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: #2c3e50;
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            text-align: center;
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .module {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .module:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .module h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .icon {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        .btn.danger {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
        }

        .btn.success {
            background: linear-gradient(135deg, #00b894, #00a085);
        }

        .input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            margin: 8px 0;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .input:focus {
            outline: none;
            border-color: #667eea;
        }

        .status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin: 2px;
        }

        .status.active {
            background: #d4edda;
            color: #155724;
        }

        .status.alert {
            background: #f8d7da;
            color: #721c24;
        }

        .status.warning {
            background: #fff3cd;
            color: #856404;
        }

        .map-container {
            height: 300px;
            background: linear-gradient(45deg, #f0f2f5, #e8ecf0);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .map-overlay {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
        }

        .tourist-list {
            max-height: 250px;
            overflow-y: auto;
        }

        .tourist-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 12px;
            margin: 8px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .blockchain-record {
            background: #e8f4fd;
            border-left: 4px solid #2196f3;
            padding: 10px;
            margin: 8px 0;
            border-radius: 0 8px 8px 0;
            font-size: 12px;
        }

        .qr-code {
            width: 120px;
            height: 120px;
            background: linear-gradient(45deg, #333, #666);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            margin: 10px auto;
        }

        .analytics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .metric {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
        }

        .metric-label {
            font-size: 12px;
            color: #7f8c8d;
            margin-top: 5px;
        }

        .alert-item {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin: 8px 0;
            border-radius: 0 8px 8px 0;
        }

        .log-container {
            max-height: 200px;
            overflow-y: auto;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
        }

        .log-entry {
            font-family: monospace;
            font-size: 12px;
            margin: 5px 0;
            padding: 5px;
            background: white;
            border-radius: 5px;
        }

        .language-selector {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
            margin: 10px 0;
        }

        .lang-btn {
            background: #e9ecef;
            border: none;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .lang-btn.active {
            background: #667eea;
            color: white;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #ff6b6b;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            animation: slideIn 0.3s ease;
            display: none;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        .iot-device {
            background: #e8f5e8;
            border: 2px solid #4caf50;
            border-radius: 10px;
            padding: 10px;
            margin: 5px 0;
            font-size: 12px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab {
            background: #e9ecef;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: #667eea;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <button id="startShareBtn">Start sharing my live location</button>
    <button onclick="sendDummyLocation()">Send Dummy Location</button>
    <div class="container">
        <header class="header">
            <h1>üõ°Ô∏è Smart Tourist Safety System</h1>
            <p>AI-Powered Monitoring & Incident Response with Blockchain Digital IDs</p>
        </header>

        <div class="tabs">
            <button class="tab active" onclick="showTab('tourist')">Tourist Interface</button>
            <button class="tab" onclick="showTab('authorities')">Authority Dashboard</button>
            <button class="tab" onclick="showTab('blockchain')">Blockchain Registry</button>
            <button class="tab" onclick="showTab('analytics')">AI Analytics</button>
        </div>

        <!-- Tourist Interface -->
        <div id="tourist" class="tab-content active">
            <div class="dashboard">
                <div class="module">
                    <h3><span class="icon">üì±</span>Digital Tourist ID</h3>
                    <input type="text" class="input" id="touristName" placeholder="Full Name">
                    <input type="text" class="input" id="aadhaarNumber" placeholder="Aadhaar/Passport Number">
                    <input type="text" class="input" id="emergencyContact" placeholder="Emergency Contact">
                    <select class="input" id="visitDuration">
                        <option>Select Visit Duration</option>
                        <option value="7">7 Days</option>
                        <option value="14">14 Days</option>
                        <option value="30">30 Days</option>
                    </select>
                    <button class="btn" onclick="generateDigitalID()">Generate Digital ID</button>
                    <div id="generatedID" style="display:none;">
                        <div class="qr-code">QR CODE</div>
                        <div style="text-align:center;">
                            <strong>Tourist ID:</strong> <span id="touristID"></span><br>
                            <strong>Status:</strong> <span class="status active">Active</span>
                        </div>
                    </div>
                </div>

                <div class="module">
                    <h3><span class="icon">üåç</span>Language Support</h3>
                    <div class="language-selector">
                        <button class="lang-btn active" onclick="setLanguage('en')">English</button>
                        <button class="lang-btn" onclick="setLanguage('hi')">‡§π‡§ø‡§Ç‡§¶‡•Ä</button>
                        <button class="lang-btn" onclick="setLanguage('bn')">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</button>
                        <button class="lang-btn" onclick="setLanguage('ta')">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</button>
                        <button class="lang-btn" onclick="setLanguage('te')">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</button>
                        <button class="lang-btn" onclick="setLanguage('ml')">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</button>
                        <button class="lang-btn" onclick="setLanguage('kn')">‡≤ï‡≤®‡≥ç‡≤®‡≤°</button>
                        <button class="lang-btn" onclick="setLanguage('gu')">‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä</button>
                        <button class="lang-btn" onclick="setLanguage('mr')">‡§Æ‡§∞‡§æ‡§†‡•Ä</button>
                        <button class="lang-btn" onclick="setLanguage('pa')">‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä</button>
                    </div>
                    <div id="languageStatus">Current: English</div>
                </div>

                <div class="module">
                    <h3><span class="icon">üìç</span>Location & Safety</h3>
                    <div class="map-container">
                        <div class="map-overlay">Live Tracking: ON</div>
                        <div>üìç Current Location: Goa, India<br>
                        Safety Score: <span class="status active">85/100</span><br>
                        Zone Status: <span class="status active">Safe Zone</span></div>
                    </div>
                    <button class="btn" onclick="shareLocation()">Share Live Location</button>
                    <button class="btn danger" onclick="triggerSOS()">üö® PANIC BUTTON</button>
                </div>

                <div class="module">
                    <h3><span class="icon">üë•</span>Family Tracking</h3>
                    <label>
                        <input type="checkbox" id="familyTracking"> Enable Family Tracking
                    </label>
                    <div style="margin-top:10px;">
                        <input type="text" class="input" placeholder="Family Member Phone">
                        <button class="btn success">Add Contact</button>
                    </div>
                    <div style="margin-top:15px; font-size:12px; color:#666;">
                        Family members will receive your location updates every 30 minutes
                    </div>
                </div>
            </div>
        </div>

        <!-- Authority Dashboard -->
        <div id="authorities" class="tab-content">
            <div class="dashboard">
                <div class="module">
                    <h3><span class="icon">üó∫Ô∏è</span>Live Tourist Map</h3>
                    <div class="map-container">
                        <div class="map-overlay">Active Tourists: 1,247</div>
                        <div>
                            üî¥ High Risk Zones: 3<br>
                            üü° Medium Risk: 8<br>
                            üü¢ Safe Zones: 45<br>
                            üìç Tourist Clusters: 12
                        </div>
                    </div>
                    <div class="analytics">
                        <div class="metric">
                            <div class="metric-value">1,247</div>
                            <div class="metric-label">Active Tourists</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">23</div>
                            <div class="metric-label">Alerts Today</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">0</div>
                            <div class="metric-label">SOS Calls</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">98.2%</div>
                            <div class="metric-label">Safety Rate</div>
                        </div>
                    </div>
                </div>

                <div class="module">
                    <h3><span class="icon">üö®</span>Active Alerts</h3>
                    <div class="alert-item">
                        <strong>Geo-fence Violation</strong><br>
                        Tourist ID: TID-2024-001234<br>
                        Location: Restricted Area - Zone R7<br>
                        Time: 2 minutes ago
                        <button class="btn" style="float:right;">Investigate</button>
                    </div>
                    <div class="alert-item">
                        <strong>Prolonged Inactivity</strong><br>
                        Tourist ID: TID-2024-001198<br>
                        Last Active: 45 minutes ago<br>
                        Location: Jungle Trail #3
                        <button class="btn" style="float:right;">Contact</button>
                    </div>
                </div>

                <div class="module">
                    <h3><span class="icon">üëÆ</span>Police Operations</h3>
                    <button class="btn" onclick="generateEFIR()">Generate E-FIR</button>
                    <button class="btn" onclick="dispatchUnit()">Dispatch Unit</button>
                    <button class="btn" onclick="broadcastAlert()">Broadcast Alert</button>
                    <div style="margin-top:15px;">
                        <strong>Nearest Units:</strong><br>
                        üöì Unit-07: 2.3 km away<br>
                        üöì Unit-12: 4.1 km away<br>
                        üöë Ambulance: 1.8 km away
                    </div>
                </div>

                <div class="module">
                    <h3><span class="icon">üìä</span>Tourist Analytics</h3>
                    <div class="analytics">
                        <div class="metric">
                            <div class="metric-value">2,845</div>
                            <div class="metric-label">Today's Entries</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">67</div>
                            <div class="metric-label">Hot Spots</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">15</div>
                            <div class="metric-label">High Risk Areas</div>
                        </div>
                    </div>
                    <button class="btn" onclick="exportAnalytics()">Export Report</button>
                </div>
            </div>
        </div>

        <!-- Blockchain Registry -->
        <div id="blockchain" class="tab-content">
            <div class="dashboard">
                <div class="module">
                    <h3><span class="icon">‚õìÔ∏è</span>Blockchain Ledger</h3>
                    <div class="blockchain-record">
                        <strong>Block #247,891</strong><br>
                        Hash: 0x7d4a9f2e8b1c3a6d...<br>
                        Timestamp: 2025-09-04 14:32:18<br>
                        Transactions: 12 Digital IDs Created
                    </div>
                    <div class="blockchain-record">
                        <strong>Block #247,890</strong><br>
                        Hash: 0x3c8f7e2a5b9d4f1e...<br>
                        Timestamp: 2025-09-04 14:27:45<br>
                        Transactions: 8 ID Updates, 3 Expiries
                    </div>
                    <button class="btn" onclick="validateBlockchain()">Validate Chain</button>
                    <button class="btn" onclick="syncNodes()">Sync Nodes</button>
                </div>

                <div class="module">
                    <h3><span class="icon">üîç</span>ID Verification</h3>
                    <input type="text" class="input" id="verifyID" placeholder="Enter Tourist ID or scan QR">
                    <button class="btn" onclick="verifyTouristID()">Verify ID</button>
                    <div id="verificationResult" style="margin-top:15px; display:none;">
                        <div class="blockchain-record">
                            <strong>‚úÖ ID Verified</strong><br>
                            Tourist: John Doe<br>
                            Issued: 2025-09-01<br>
                            Expires: 2025-09-08<br>
                            Status: Active<br>
                            Blockchain Confirmations: 1,247
                        </div>
                    </div>
                </div>

                <div class="module">
                    <h3><span class="icon">üìà</span>Blockchain Stats</h3>
                    <div class="analytics">
                        <div class="metric">
                            <div class="metric-value">247,891</div>
                            <div class="metric-label">Total Blocks</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">89,234</div>
                            <div class="metric-label">Active IDs</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">99.98%</div>
                            <div class="metric-label">Uptime</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">0.003s</div>
                            <div class="metric-label">Avg Query Time</div>
                        </div>
                    </div>
                </div>

                <div class="module">
                    <h3><span class="icon">üîê</span>Security Audit</h3>
                    <div class="log-container">
                        <div class="log-entry">[2025-09-04 14:32:45] Network consensus achieved</div>
                        <div class="log-entry">[2025-09-04 14:32:23] New block mined successfully</div>
                        <div class="log-entry">[2025-09-04 14:31:58] 12 transactions validated</div>
                        <div class="log-entry">[2025-09-04 14:31:45] Security scan completed - No threats</div>
                        <div class="log-entry">[2025-09-04 14:31:12] Cryptographic integrity verified</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Analytics -->
        <div id="analytics" class="tab-content">
            <div class="dashboard">
                <div class="module">
                    <h3><span class="icon">ü§ñ</span>AI Anomaly Detection</h3>
                    <div class="analytics">
                        <div class="metric">
                            <div class="metric-value">23</div>
                            <div class="metric-label">Anomalies Detected</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">98.7%</div>
                            <div class="metric-label">Accuracy Rate</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">156ms</div>
                            <div class="metric-label">Processing Time</div>
                        </div>
                    </div>
                    <button class="btn" onclick="runAnomalyDetection()">Run Detection</button>
                    <button class="btn" onclick="retrainModel()">Retrain Model</button>
                </div>

                <div class="module">
                    <h3><span class="icon">üìä</span>ML Model Performance</h3>
                    <div class="log-container">
                        <div class="log-entry">üü¢ Location Drop-off Detection: 99.2% accuracy</div>
                        <div class="log-entry">üü° Inactivity Pattern Analysis: 87.5% accuracy</div>
                        <div class="log-entry">üü¢ Route Deviation Detection: 94.8% accuracy</div>
                        <div class="log-entry">üü¢ Behavioral Anomaly Detection: 91.3% accuracy</div>
                        <div class="log-entry">üü¢ Risk Score Calculation: 96.7% accuracy</div>
                    </div>
                    <button class="btn" onclick="viewModelDetails()">View Details</button>
                </div>

                <div class="module">
                    <h3><span class="icon">üåê</span>IoT Device Monitoring</h3>
                    <div class="iot-device">
                        üì± Smart Band #SB-2024-001: Active<br>
                        Location: Adventure Trail<br>
                        Battery: 78% | Heart Rate: 82 bpm
                    </div>
                    <div class="iot-device">
                        üìç GPS Tracker #GT-2024-045: Active<br>
                        Location: Beach Resort<br>
                        Signal: Strong | Last Update: 30s ago
                    </div>
                    <div class="iot-device">
                        ‚åö Wearable #WD-2024-123: Alert<br>
                        Location: Mountain Trail<br>
                        Issue: No movement detected for 20 minutes
                    </div>
                </div>

                <div class="module">
                    <h3><span class="icon">üìà</span>Predictive Analytics</h3>
                    <div style="background:#f8f9fa; padding:15px; border-radius:10px;">
                        <strong>Risk Predictions for Next 24 Hours:</strong><br>
                        üî¥ High Risk: Monsoon areas (Beach Zone 3-7)<br>
                        üü° Medium Risk: Mountain trails after 6 PM<br>
                        üü¢ Low Risk: City center and hotel districts<br><br>
                        <strong>Recommended Actions:</strong><br>
                        ‚Ä¢ Increase patrol frequency in Beach Zone 5<br>
                        ‚Ä¢ Deploy additional units to mountain areas<br>
                        ‚Ä¢ Weather alert for coastal regions
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="notification" class="notification">
        <span id="notificationText">Alert sent successfully!</span>
    </div>

    <script>
        // Simulated data storage (replacing localStorage)
        let systemData = {
            tourists: [],
            alerts: [],
            blockchainBlocks: [],
            currentLanguage: 'en',
            activeTourists: 1247,
            currentUser: null
        };

        // Language translations
        const translations = {
            en: {
                panic: "PANIC BUTTON",
                safe: "You are in a safe zone",
                help: "Help is on the way"
            },
            hi: {
                panic: "‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§¨‡§ü‡§®",
                safe: "‡§Ü‡§™ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§π‡•à‡§Ç",
                help: "‡§Æ‡§¶‡§¶ ‡§Ü‡§®‡•á ‡§µ‡§æ‡§≤‡•Ä ‡§π‡•à"
            },
            ta: {
                panic: "‡ÆÖ‡Æµ‡Æö‡Æ∞ ‡§¨‡§ü‡§®‡Øç",
                safe: "‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡Ææ‡Æ§‡ØÅ‡Æï‡Ææ‡Æ™‡Øç‡Æ™‡Ææ‡Æ© ‡Æ™‡Æï‡ØÅ‡Æ§‡Æø‡ÆØ‡Æø‡Æ≤‡Øç ‡Æâ‡Æ≥‡Øç‡Æ≥‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç",
                help: "‡Æâ‡Æ§‡Æµ‡Æø ‡Æµ‡Æ∞‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ"
            }
        };

        function showTab(tabName) {
            // Hide all tab contents
            const contents = document.querySelectorAll('.tab-content');
            const tabs = document.querySelectorAll('.tab');
            
            contents.forEach(content => content.classList.remove('active'));
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        function generateDigitalID() {
            const name = document.getElementById('touristName').value;
            const aadhaar = document.getElementById('aadhaarNumber').value;
            const emergency = document.getElementById('emergencyContact').value;
            const duration = document.getElementById('visitDuration').value;
            
            if (!name || !aadhaar || !emergency || !duration) {
                showNotification('Please fill all required fields', 'error');
                return;
            }
            
            // Generate unique tourist ID
            const touristID = 'TID-' + new Date().getFullYear() + '-' + 
                             String(Math.floor(Math.random() * 1000000)).padStart(6, '0');
            
            // Create blockchain record
            const blockchainRecord = {
                id: touristID,
                name: name,
                aadhaar: aadhaar,
                emergency: emergency,
                duration: duration,
                issueDate: new Date().toISOString(),
                expiryDate: new Date(Date.now() + parseInt(duration) * 24 * 60 * 60 * 1000).toISOString(),
                hash: generateHash(),
                status: 'active'
            };
            
            systemData.tourists.push(blockchainRecord);
            systemData.currentUser = blockchainRecord;
            
            // Show generated ID
            document.getElementById('touristID').textContent = touristID;
            document.getElementById('generatedID').style.display = 'block';
            
            showNotification('Digital Tourist ID generated successfully!');
            
            // Simulate blockchain mining
            setTimeout(() => {
                showNotification('ID recorded on blockchain - Block #' + (247891 + Math.floor(Math.random() * 100)));
            }, 2000);
        }

        function generateHash() {
            return '0x' + Math.random().toString(16).substr(2, 16) + '...';
        }

        function setLanguage(lang) {
            systemData.currentLanguage = lang;
            
            // Update active language button
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update language status
            const langNames = {
                'en': 'English', 'hi': '‡§π‡§ø‡§Ç‡§¶‡•Ä', 'bn': '‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ', 'ta': '‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç',
                'te': '‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å', 'ml': '‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç', 'kn': '‡≤ï‡≤®‡≥ç‡≤®‡≤°', 'gu': '‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä',
                'mr': '‡§Æ‡§∞‡§æ‡§†‡•Ä', 'pa': '‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä'
            };
            
            document.getElementById('languageStatus').textContent = `Current: ${langNames[lang]}`;
            
            showNotification(`Language changed to ${langNames[lang]}`);
        }

        function shareLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    
                    showNotification(`Location shared: ${lat.toFixed(4)}, ${lng.toFixed(4)}`);
                    
                    // Simulate family notification
                    setTimeout(() => {
                        showNotification('Family members notified of your location');
                    }, 1500);
                });
            } else {
                showNotification('Location sharing not supported', 'error');
            }
        }

        function triggerSOS() {
            const currentLang = systemData.currentLanguage;
            const sosMessage = translations[currentLang] ? translations[currentLang].panic : translations.en.panic;
            
            // Create SOS alert
            const sosAlert = {
                id: 'SOS-' + Date.now(),
                touristId: systemData.currentUser ? systemData.currentUser.id : 'Unknown',
                type: 'SOS',
                message: 'Emergency SOS activated',
                location: 'Current GPS Location',
                timestamp: new Date().toISOString(),
                status: 'active'
            };
            
            systemData.alerts.push(sosAlert);
            
            showNotification(`üö® ${sosMessage} - Emergency services alerted!`, 'danger');
            
            // Simulate emergency response
            setTimeout(() => {
                showNotification('Nearest police unit dispatched - ETA 8 minutes');
            }, 2000);
            
            setTimeout(() => {
                showNotification('Emergency contacts notified');
            }, 3000);
        }

        function generateEFIR() {
            const efirNumber = 'EFIR-' + new Date().getFullYear() + '-' + 
                              String(Math.floor(Math.random() * 100000)).padStart(5, '0');
            
            showNotification(`E-FIR generated: ${efirNumber}`);
            
            // Simulate E-FIR processing
            setTimeout(() => {
                showNotification('E-FIR submitted to central database');
            }, 1500);
        }

        function dispatchUnit() {
            const unitNumber = 'Unit-' + String(Math.floor(Math.random() * 50)).padStart(2, '0');
            showNotification(`${unitNumber} dispatched - ETA 12 minutes`);
        }

        function broadcastAlert() {
            showNotification('Alert broadcasted to all nearby units');
        }

        function exportAnalytics() {
            showNotification('Analytics report exported successfully');
        }

        function validateBlockchain() {
            showNotification('Blockchain validation in progress...');
            
            setTimeout(() => {
                showNotification('‚úÖ Blockchain integrity verified - All blocks valid');
            }, 2000);
        }

        function syncNodes() {
            showNotification('Syncing with network nodes...');
            
            setTimeout(() => {
                showNotification('‚úÖ Successfully synced with 47 nodes');
            }, 3000);
        }

        function verifyTouristID() {
            const idInput = document.getElementById('verifyID').value;
            
            if (!idInput) {
                showNotification('Please enter a Tourist ID', 'error');
                return;
            }
            
            // Simulate ID verification
            setTimeout(() => {
                document.getElementById('verificationResult').style.display = 'block';
                showNotification('‚úÖ Tourist ID verified successfully');
            }, 1000);
        }

        function runAnomalyDetection() {
            showNotification('Running AI anomaly detection...');
            
            // Simulate AI processing
            setTimeout(() => {
                const anomaliesFound = Math.floor(Math.random() * 5);
                showNotification(`AI scan complete - ${anomaliesFound} anomalies detected`);
                
                if (anomaliesFound > 0) {
                    setTimeout(() => {
                        showNotification('Anomalies flagged for manual review');
                    }, 1000);
                }
            }, 3000);
        }

        function retrainModel() {
            showNotification('Initiating model retraining...');
            
            setTimeout(() => {
                showNotification('Model retraining completed - Accuracy improved to 99.1%');
            }, 5000);
        }

        function viewModelDetails() {
            showNotification('Opening detailed model analytics...');
        }

        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            notificationText.textContent = message;
            
            // Set notification color based on type
            switch(type) {
                case 'error':
                    notification.style.background = '#ff6b6b';
                    break;
                case 'success':
                    notification.style.background = '#00b894';
                    break;
                case 'warning':
                    notification.style.background = '#fdcb6e';
                    break;
                case 'danger':
                    notification.style.background = '#e17055';
                    break;
                default:
                    notification.style.background = '#667eea';
            }
            
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 4000);
        }

        // Simulated real-time updates
        function simulateRealTimeUpdates() {
            setInterval(() => {
                // Randomly update tourist count
                const variance = Math.floor(Math.random() * 20) - 10;
                systemData.activeTourists = Math.max(1000, systemData.activeTourists + variance);
                
                // Update displayed metrics
                const metrics = document.querySelectorAll('.metric-value');
                if (metrics.length > 0) {
                    metrics[0].textContent = systemData.activeTourists.toLocaleString();
                }
                
                // Simulate occasional alerts
                if (Math.random() < 0.1) { // 10% chance every interval
                    const alertTypes = ['Geo-fence violation', 'Unusual activity', 'Device offline', 'Route deviation'];
                    const randomAlert = alertTypes[Math.floor(Math.random() * alertTypes.length)];
                    
                    if (Math.random() < 0.3) { // Only show 30% of generated alerts as notifications
                        showNotification(`New alert: ${randomAlert}`, 'warning');
                    }
                }
            }, 10000); // Update every 10 seconds
        }

        // Geofencing simulation
        function simulateGeofencing() {
            setInterval(() => {
                // Simulate geo-fence checks
                if (Math.random() < 0.05) { // 5% chance of geo-fence alert
                    const zones = ['Restricted Military Zone', 'Dangerous Wildlife Area', 'Construction Site', 'Private Property'];
                    const randomZone = zones[Math.floor(Math.random() * zones.length)];
                    
                    showNotification(`‚ö†Ô∏è Geo-fence Alert: Tourist entered ${randomZone}`, 'warning');
                }
            }, 15000); // Check every 15 seconds
        }

        // AI anomaly detection simulation
        function simulateAnomalyDetection() {
            setInterval(() => {
                if (Math.random() < 0.03) { // 3% chance of anomaly detection
                    const anomalies = [
                        'Sudden location drop-off detected',
                        'Prolonged inactivity pattern',
                        'Unusual route deviation',
                        'Communication silence detected'
                    ];
                    const randomAnomaly = anomalies[Math.floor(Math.random() * anomalies.length)];
                    
                    showNotification(`ü§ñ AI Alert: ${randomAnomaly}`, 'warning');
                }
            }, 20000); // Check every 20 seconds
        }

        // Blockchain mining simulation
        function simulateBlockchainMining() {
            setInterval(() => {
                if (Math.random() < 0.2) { // 20% chance of new block
                    const blockNumber = 247891 + Math.floor(Math.random() * 1000);
                    showNotification(`‚õìÔ∏è New block mined: #${blockNumber}`);
                }
            }, 30000); // Check every 30 seconds
        }

        // IoT device status simulation
        function simulateIoTUpdates() {
            setInterval(() => {
                // Simulate IoT device updates
                const devices = document.querySelectorAll('.iot-device');
                devices.forEach(device => {
                    if (Math.random() < 0.1) { // 10% chance of status update
                        const batteryLevel = Math.floor(Math.random() * 40) + 60; // 60-100%
                        const heartRate = Math.floor(Math.random() * 40) + 70; // 70-110 bpm
                        
                        if (device.textContent.includes('Battery:')) {
                            device.innerHTML = device.innerHTML.replace(/Battery: \d+%/, `Battery: ${batteryLevel}%`);
                            device.innerHTML = device.innerHTML.replace(/Heart Rate: \d+ bpm/, `Heart Rate: ${heartRate} bpm`);
                        }
                    }
                });
            }, 12000); // Update every 12 seconds
        }

        // Initialize system
        function initializeSystem() {
            // Show welcome notification
            setTimeout(() => {
                showNotification('üõ°Ô∏è Smart Tourist Safety System Initialized');
            }, 1000);
            
            // Start simulations
            simulateRealTimeUpdates();
            simulateGeofencing();
            simulateAnomalyDetection();
            simulateBlockchainMining();
            simulateIoTUpdates();
            
            // Auto-enable family tracking for demo
            setTimeout(() => {
                document.getElementById('familyTracking').checked = true;
                showNotification('Family tracking enabled for demo');
            }, 3000);
        }

        // Voice accessibility for SOS
        function setupVoiceAccessibility() {
            if ('speechSynthesis' in window) {
                // Voice command detection simulation
                document.addEventListener('keydown', function(e) {
                    // Simulate voice activation with 'V' key for demo
                    if (e.key.toLowerCase() === 'v' && e.ctrlKey) {
                        e.preventDefault();
                        const utterance = new SpeechSynthesisUtterance('Voice SOS activated. Emergency services alerted.');
                        utterance.lang = 'en-US';
                        speechSynthesis.speak(utterance);
                        triggerSOS();
                    }
                });
                
                // Add voice instruction
                setTimeout(() => {
                    showNotification('Voice accessibility: Press Ctrl+V for voice SOS');
                }, 8000);
            }
        }

        // Privacy and encryption simulation
        function simulateEncryption() {
            // Simulate end-to-end encryption status
            setInterval(() => {
                if (Math.random() < 0.05) { // 5% chance
                    showNotification('üîê All communications encrypted and secure');
                }
            }, 45000); // Every 45 seconds
        }

        // Weather and environmental alerts
        function simulateEnvironmentalAlerts() {
            const weatherConditions = [
                'Heavy rainfall warning in coastal areas',
                'High tide alert for beach zones',
                'Fog warning for mountain regions',
                'Temperature alert: Extreme heat in desert areas',
                'Wind speed alert for adventure activities'
            ];
            
            setInterval(() => {
                if (Math.random() < 0.08) { // 8% chance
                    const randomWeather = weatherConditions[Math.floor(Math.random() * weatherConditions.length)];
                    showNotification(`üå¶Ô∏è Weather Alert: ${randomWeather}`, 'warning');
                }
            }, 25000); // Every 25 seconds
        }

        // Emergency contact simulation
        function simulateEmergencyContacts() {
            setInterval(() => {
                if (Math.random() < 0.02) { // 2% chance
                    showNotification('üìû Emergency contact automatically notified of location update');
                }
            }, 35000); // Every 35 seconds
        }

        // Initialize everything when page loads
        window.addEventListener('load', function() {
            initializeSystem();
            setupVoiceAccessibility();
            simulateEncryption();
            simulateEnvironmentalAlerts();
            simulateEmergencyContacts();
        });

        // Accessibility enhancements
        document.addEventListener('keydown', function(e) {
            // Quick SOS activation with F1 key
            if (e.key === 'F1') {
                e.preventDefault();
                triggerSOS();
            }
            
            // Quick location share with F2
            if (e.key === 'F2') {
                e.preventDefault();
                shareLocation();
            }
        });

        // Mobile responsiveness helper
        function adjustForMobile() {
            if (window.innerWidth < 768) {
                const modules = document.querySelectorAll('.module');
                modules.forEach(module => {
                    module.style.padding = '15px';
                });
                
                const dashboard = document.querySelector('.dashboard');
                dashboard.style.gridTemplateColumns = '1fr';
            }
        }

        window.addEventListener('resize', adjustForMobile);
        window.addEventListener('load', adjustForMobile);

        // Service worker registration simulation (for offline capability)
        if ('serviceWorker' in navigator) {
            setTimeout(() => {
                showNotification('üì± Offline mode enabled - System will work without internet');
            }, 12000);
        }

        // Battery optimization for mobile devices
        function optimizeBattery() {
            // Reduce update frequency when battery is low
            if ('getBattery' in navigator) {
                navigator.getBattery().then(function(battery) {
                    if (battery.level < 0.2) { // Less than 20% battery
                        showNotification('üîã Battery saver mode activated - Reduced tracking frequency');
                    }
                });
            }
        }

        setTimeout(optimizeBattery, 5000);

        // Dark mode toggle (accessibility feature)
        function toggleDarkMode() {
            document.body.style.filter = document.body.style.filter === 'invert(1) hue-rotate(180deg)' ? 'none' : 'invert(1) hue-rotate(180deg)';
        }

        // Add keyboard shortcut for dark mode
        document.addEventListener('keydown', function(e) {
            if (e.key === 'D' && e.ctrlKey && e.shiftKey) {
                e.preventDefault();
                toggleDarkMode();
            }
        });

        console.log('üõ°Ô∏è Smart Tourist Safety System Loaded Successfully');
        console.log('üì± Features: Digital ID, AI Anomaly Detection, Blockchain Registry, IoT Integration');
        console.log('üîß Keyboard Shortcuts: F1=SOS, F2=Share Location, Ctrl+V=Voice SOS, Ctrl+Shift+D=Dark Mode');
    </script> 
  

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>

 <script>
  // Use the same Firebase config as Page 2
  const firebaseConfig = {
    apiKey: "AIzaSyCMNY0CCsEGBkdD1HBM-Rs31ASdFJ9Qv18",
    authDomain: "smart-tourist-safety-system.firebaseapp.com",
    databaseURL: "https://smart-tourist-safety-system-default-rtdb.firebaseio.com",
    projectId: "smart-tourist-safety-system",
    storageBucket: "smart-tourist-safety-system.firebasestorage.app",
    messagingSenderId: "907315597836",
    appId: "1:907315597836:web:e3fb661ee819d47484d429",
    measurementId: "G-EB4KF0Q2E0"
  };

  // Initialize Firebase app
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

 // üîπ Send Dummy Location
    function sendDummyLocation() {
      const touristID = "TEST-1234"; // Dummy ID
      const lat = 28.6129; // India Gate latitude
      const lng = 77.2295; // India Gate longitude

      db.ref("tourists/" + touristID).set({
        name: "Test Tourist",
        lat: lat,
        lng: lng,
        timestamp: Date.now()
      });

      alert("‚úÖ Dummy location sent to Firebase!");
    }

    // üîπ Share Real Location
    function shareLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition((pos) => {
          const touristID = "LIVE-1234";
          const lat = pos.coords.latitude;
          const lng = pos.coords.longitude;

          db.ref("tourists/" + touristID).set({
            name: document.getElementById("touristName").value || "Unnamed Tourist",
            lat: lat,
            lng: lng,
            timestamp: Date.now()
          });

          alert("‚úÖ Live location shared to Firebase!");
        });
      } else {
        alert("Geolocation not supported in this browser.");
      }
    }
  </script>
</body>
</html>
